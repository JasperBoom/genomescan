# Python scripts
Below is a description of the purpose of the different python scripts in this  
repository.

## analyse-exomiser-files.py
This script requires a folder with custom Exomiser tsv files and a number of
cores. It then uses the predicted and known class columns to calculate
performance metrics and create a ROC plot.

## benchmark.py
This script takes as input a set of keywords (diseases), a clinvar vcf, a
file with a vcf header to use for the output, some locations to write the
output to and the giab HG001 vcf annotated by vep.  
It uses the search terms to collect ids from the online clinvar database,
uses these ids to get the vcf entries that match from the clinvar vcf,
adds these variants to the output files as pathogenic variants.  
It also processes the giab vcf,
selecting all variants with an allele frequency (population) above 5%,
and adds these variants as benign variants to the output.  
The fields of all variants, like INFO, QUAL and FILTER are replaced so that
vep can be used for annotation.

## calculate-final-rank.py


## collect-exomiser-files.py
This script takes as input a folder with subfolders for both FULL and PASS_ONLY
results from Exomiser. These subfolders contain more subfolders for each
tested minimal priority score. The script then collects the vcf files in
each minimal priority score folder, extracts the Exomiser information and
class information from each variant, and writes them to tsv files. These
tsv files are used by analyse-exomiser-files.py.

## combine-vcf.py
This script takes as input a vcf file from the PGP-UK project, a vcf file with
pathogenic variants (generated by benchmark.py), a tabular file from vep
(this contains subsets of the pathogenic variants that were created with a
R script), a default vcf header and a output location.  
It then grabs the pathogenic variant ids from the tabular file,
gets the variant lines from the vcf that match these ids,
and adds these lines to the PGP-UK individual vcf.

## imiv.py
This script takes as input a vcf file genomescan dragen pipeline, the stats
file that genomescan generates for a batch (group of samples), a vcf file
with pathogenic variants associated with meningioma, and an output location.  
This script simply selects a meningioma variant at random,
adds this variant to the patient vcf,
and names the output file in such a way the sample is known, the gene on
which the variant is located is known and the gender of the patient is known.

## oop-tutorial.py
This script is used to test out code from the OOP tutorial on realpython.com.  
A load of dummy classes and functions.

## prepare-exomiser-files.py
This script takes as input a load of settings specific to Exomiser. It also
requires a vcf file to use as training data. It then runs Exomiser on this
training data, using SLURM, with a bunch of different minimal priority scores.
The results are written to a folder for each minimal priority score. Exomiser
is run in both FULL and PASS_ONLY mode, in order to check which variants pass
all filters.

## training-test-subsets.py
This script takes as input an output folder, pathogenic variants from clinvar
in vcf format, a PGP-UK individual to use for testing and a PGP-UK individual
to use for training (both also in vcf format).  
It splits the pathogenic variants in two random subsets,
adds these subsets to the individuals, one for each,
and writes the newly combined files to the output folder.

## uk-genome-project.py
This script takes as input a vep annotated tsv file from the PGP-UK project,
a number of lines to skip (based on the tsv file) for the PGP-UK individual,
a number of lines to skip for the clinvar tsv, the clinvar vep annotated tsv,
and an output location.  
The script then combines the two tsv files, where the PGP-UK individuals
variants are classified as benign, the clinvar variants are pathogenic,
duplicates lines are removed, and a new tsv file is created.